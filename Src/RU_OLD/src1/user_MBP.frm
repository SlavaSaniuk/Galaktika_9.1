.LinkForm 'SPIS_MBP_006' Prototype is 'SPIS_MBP'
.Group 'Акт на списание МБП'
.Group 'Акт на списание МБП (Россия)'
.NameInList 'МС Акт выбытия'
.p 40
.DEFO PORTRAIT
.LL 80
.var
  TotSum:Double
  IznSum:Double
  KolStr:Integer
  KolStr2:Integer
  KolPage:Integer
  KolPage2:Integer
  KolLine:Integer
  i:Integer
  arKolStr: ARRAY [1..2] of Integer
  arDate: ARRAY [1..2] of String
  arFIO: ARRAY [1..2] of String
  arTabN: ARRAY [1..2] of String
  arPerc: ARRAY [1..2] of Double
  arOstSt: ARRAY [1..2] of Double
  Header:String
  NomAct:String
  Org:String
  OKPO:String
  Podraz:String
  DatAct:String
  Номер_члена_комиссии:Word
  Массив_Член_комиссии_nRec: ARRAY [1..2] of Comp
  Массив_Член_комиссии_ФИО: ARRAY [1..2] of String
  Массив_Член_комиссии_Табельный_Номер: ARRAY [1..2] of String
  Массив_Член_комиссии_Должность: ARRAY [1..2] of String
.endvar
.fields
  Header
  NomAct
  Org
  OKPO
  Podraz
  DatAct
  Podraz
  MBPName
  MBPNum
  MBPEd
  Kol
  Price
  if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
  SumIsn//  PrKod//  PrName
  TotSum
  IznSum
  arFIO  [KolStr2 + KolStr]
  arTabN [KolStr2 + KolStr]
  DatAct//  arDate [KolStr2 + KolStr]
  arPerc [KolStr2 + KolStr]
  arOstSt[KolStr2 + KolStr]
.endfields
.{
.begin
  Номер_члена_комиссии := 0;


  for (Номер_члена_комиссии := 1; Номер_члена_комиссии <= Count(Массив_Член_комиссии_nRec); Номер_члена_комиссии := Номер_члена_комиссии + 1)
  {
    Массив_Член_комиссии_nRec            [Номер_члена_комиссии] := comp(0);
    Массив_Член_комиссии_ФИО             [Номер_члена_комиссии] := '';
    Массив_Член_комиссии_Табельный_Номер [Номер_члена_комиссии] := '';
    Массив_Член_комиссии_Должность       [Номер_члена_комиссии] := '';
  }

  Номер_члена_комиссии := 0;
end.
.{CheckEnter COMMISSIONMEMBER_SPISMBPPROT
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
  Массив_Член_комиссии_nRec            [Номер_члена_комиссии] := Член_комиссии_nRec;
  Массив_Член_комиссии_ФИО             [Номер_члена_комиссии] := Член_комиссии_ФИО;
  Массив_Член_комиссии_Табельный_Номер [Номер_члена_комиссии] := string(Член_комиссии_Табельный_Номер);
  Массив_Член_комиссии_Должность       [Номер_члена_комиссии] := Член_комиссии_Должность;
end.
.}
.begin
  Номер_члена_комиссии := 0;
end.
.begin
  KolStr   := 0
  KolStr2  := 0
  KolPage  := 0
  KolPage2 := 0
  Header := CommonFormHeader
  NomAct := Nom
  Org    :=  MyOrg
  OKPO   := ОКПО
  Podraz := Podr
  DatAct := DateToStr( Dat, 'DD/MM/YYYY')
end.
.{CheckEnter SPSPIS
.[H
.begin
 TotSum := 0
 IznSum := 0
 KolPage := KolPage + 1
 KolStr2 := KolStr2 + KolStr
 KolStr := 0
end.
  Р^

                                       БАКТ № Б  Е@@@@@@@@@@ Е                                                              ┌─────────────┐
                    Бвыбытия малоценных и быстроизнашивающихся предметов Б                                              │     Коды    │
                                                                                                                    ├─────────────┤
                                                                                                      Форма по ОКУД │   0320002   │
                                                                                                                    ├─────────────┤
 Организация   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е          по ОКПО │@~@@@@@@@@@@@│
                             Е                                                                       Е                  └─────────────┘
 Структурное подразделение   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                               ┌──────────┬──────────┬────────────────────────────┐
                                                                               │   Дата   │   Код    │       Cтруктурное          │
                                                                               │  состав- │   вида   │      подразделение         │
                                                                               │   ления  │ операции │                            │
                                                                               │          │          │                            │
                                                                               ├──────────┼──────────┼────────────────────────────┤
                                                                               │ Б@@@@@@@@@@ Б│          │ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б│
                                                                               └──────────┴──────────┴────────────────────────────┘
┌────────────────────────────────────────────────────────────┬─────────────────┬──────┬──────────────┬────────────────────────────┐
│                        Предмет                             │Единица измерения│      │              │      Сумма, руб. коп.      │
├───────────────────────────────────────────────┬────────────┼───┬─────────────┤ Коли-│    Цена,     ├─────────────┬──────────────┤
│    Наименование,                              │Номенклатур-│Код│ Наименование│чество│   руб.коп.   │  Без учета  │   Аморти-    │
│  сорт,размер,марка                            │ ный  номер │   │             │      │              │     НДС     │   зации      │
├───────────────────────────────────────────────┼────────────┼───┼─────────────┼──────┼──────────────┼─────────────┼──────────────┤
│                        1                      │     2      │ 3 │      4      │   5  │      6       │      7      │       8      │
├───────────────────────────────────────────────┼────────────┼───┼─────────────┼──────┼──────────────┼─────────────┼──────────────┤
.]H
.begin
 i := 0;
end.
.{while ((GroupWrap(MBPName, i + 1, 21) <> '') or (GroupWrap(MBPNum, i + 1, 12) <> '') or (GroupWrap(PrName, i + 1, 17) <> ''))
.begin
 i := i + 1;
end.
.}
.begin
 KolLine := KolLine + i;

 if (4 - KolLine < 0)
   i := 4 - KolLine + i;
 else
    i := 0;
end.
.{while ((i > 0) and (KolStr > 0))
│                                               │            │   │             │      │              │             │              │
.begin
  i := i - 1;
end.
.}
.begin
 TotSum := TotSum + if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
 IznSum := IznSum + SumIsn
 KolStr := KolStr + 1
 arDate [KolStr2 + KolStr] := if ( LongInt( explDate) > 0, DateToStr( explDate, 'DD/MM/YYYY'), '')
 arFIO  [KolStr2 + KolStr] := PersFIO
 arTabN [KolStr2 + KolStr] := TabNum
 arPerc [KolStr2 + KolStr] := tPerc
 arOstSt[KolStr2 + KolStr] := OstStoim
end.
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@│   │@@@@@@@@@@@@@│&&&.&&│&'&&&&&&&&&.&&│&#'&&&&&&&.&&│ &#'&&&&&&&.&&│
.[F
.begin
  arKolStr[KolPage] := KolStr
  KolLine := KolLine - 4;
end.
└───────────────────────────────────────────────┴────────────┴───┴─────────────┴──────┴──────────────┼─────────────┼──────────────┤
                                                                                               БИтого Б  │ Б&#'&&&&&&&.&& Б│ Б &#'&&&&&&&.&& Б│
 Причина выбытия __________________________________________________                                  └─────────────┴──────────────┘
                 __________________________________________________________________________________________________________________
                 __________________________________________________________________________________________________________________

  БМастер (исполнитель работ) Б   _________________     _______________________
                                   подпись            расшифровка подписи

.]F
.}
.begin
  KolStr := 0
  KolStr2 := 0
end.
.{while (KolPage2 < KolPage)
.begin
  KolStr2 := KolStr2 + KolStr
  KolStr := 0
  KolPage2 := KolPage2 + 1
end.

.{?internal;KolPage2 > 1
 
.}
                                                                                                    Оборотная сторона формы
 ┌───────────────────────┬─────────┬──────────┬──────────────┬───────────────────────────────────────────────────────┬─────────────┐
 │                       │         │          │              │               Расчет удержания                        │             │
 │                       │         │          │              │                                                       │             │
 │   Фамилия, И., О.     │Табельный│   Дата   │   Подпись    ├───────┬────────────┬──────────────────────┬───────────┤             │
 │                       │  номер  │ передачи │   сдавшего   │       │ стоимость  │       НДС            │           │Подпись лица,│
 │                       │         │          │  малоценные  │процент│ за вычетом ├──────────────────────┤           │получившего  │
 │                       │         │          │  и быстроиз- │аморти-│амортизации,├─────────┬────────────┤           │    ТМЦ      │
 │                       │         │          │ нашивающиеся │ зации │ руб. коп.  │ размер  │   cумма,   │   сумма,  │             │
 │                       │         │          │предметы (МОЛ)│       │            │(процент)│  руб. кол. │  руб.коп  │             │
 ├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
 │           1           │    2    │    3     │       4      │   5   │     6      │    7    │      8     │     9     │     10      │
 ├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤ Б
.{while (KolStr < arKolStr[KolPage2])
.begin
  KolStr := KolStr + 1
end.
 Б │@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@│@~@@@@@@@@│              │&#'&.&&│&#'&&&&&&.&&│         │            │           │             │
.}
 └───────────────────────┴─────────┴──────────┴──────────────┴───────┴────────────┴─────────┴────────────┴───────────┴─────────────┘ Б
 Б

    "  " ___________201   г. Б
.}

.}
.endform
